<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.gstatic.com"> 
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="html2canvas.js"></script>
  <title>字體轉圖片</title>
  <style>
      
  body {
  margin:0px;
  padding:0px;
  }
.box {
width:100%;
height:100%;
background:#fff;
border-radius:0px;
padding:0px;
display: flex;
  justify-content: center;
  align-items: center;
word-break: break-all;
position: fixed;
top:0px;
left:0%;
overflow: hidden;
}
* {-webkit-appearance:none;outline:none; -webkit-tap-highlight-color:rgba(0,0,0,0);}
.filebtn {
background:url(openfilebtn.png);
background-size:cover;
border-radius:8px;
width:120px;
height:37px;
}
#files {
display:none;
}
.bar {
width:150px;
height:15px;
background:#e3e3e3;
border-radius:99em;

overflow:hidden;

}
.expbtn {
background:url(exportbtn.png);
background-size:cover;
border-radius:8px;
width:120px;
height:37px;
}
    

.bar .bar2 {
width:10%;
height:15px;
background:#0067FF;
border-radius:99em;
}
.line {
height:100vh;
width:2px;
background:#e3e3e3;
}
#textoutput {
padding:10px;
background:transparent;
}
    p{font-family: 'Noto Sans TC', sans-serif;font-weight:400}
    h1 {font-family: 'Noto Sans TC', sans-serif;font-weight:900}
    #text ,#textsize ,#textcolor,#textbg {
      width:150px;
      height:45px;
      font-size:30px;
      color:#333;
      font-family: 'Noto Sans TC', sans-serif;font-weight:300;
      border:none;
      border-bottom:3px #333 solid;
      border-radius:0;
      padding:3px;
    }
    #textsizelab ,#textcolors,#textbgs {
     font-size:30px;
      color:#333;
      font-family: 'Noto Sans TC', sans-serif;font-weight:300;
    }
    
    #outimage img {
     max-width:80%;
     max-height:80%;
     width:auto;
     height:auto;
    }
      @media only screen and (min-width: 600px) {
#outimage {
      width:50%;
      height:100%;
      position:absolute;
      top:0px;
      left:0px;
      background:url(block.png);
      background-repeat: repeat;
      background-size:10px;
    }
    #op {
      width:50%;
      height:100%;
      position:absolute;
      right:0px;
      top:0px;
      background:#fff;
      font-size:30px;
      color:#333;
      font-family: 'Noto Sans TC', sans-serif;font-weight:300;
      padding:10px;
    }
}
@media only screen and (max-width: 600px) {
    #outimage {
      width:100%;
      height:50%;
      position:absolute;
      top:0px;
      left:0px;
      background:url(block.png);
      background-repeat: repeat;
      background-size:10px;
    }
    #op {
      width:100%;
      height:50%;
      position:absolute;
      bottom:0px;
      left:0px;
      background:#fff;
      font-size:30px;
      color:#333;
      font-family: 'Noto Sans TC', sans-serif;font-weight:300;
      padding:10px;
    }
}
</style>
<style id="style"></style>
</head>
<body>
  <div class="box" id="open" style="justify-content:none; flex-direction: column; align-items: none;">
  <div id="textoutput" style="font-family: font;"></div>
  </div>
<div class="box" id="open" style="justify-content:none; flex-direction: column; align-items: none;">
<h1>字體轉圖片</h1>
<label for="files">
<div class="filebtn"></div>
<input type="file" id="files" name="files" />
</label><br>
<p>目前只支援TTF(truetype)</p>

</div>

<div class="box" id="loadbox"style="justify-content:none; flex-direction: column; align-items: none;">
<p>正在載入字體</p>
<div class="bar"><div class="bar2"></div></div>

</div>
<br>

<div class="box" id="outbox" style="justify-content:none; flex-direction: column; align-items: none;">


  <center><span id="outimage"></span></center>
  <span id="op">
    文字:<input id="text" onchange="textout()"><br>
<label for="textsize" id="textsizelab">
  大小:<input id="textsize" name="textsize" onchange="textout()" value="20px">
  </label><br>
  <label for="textcolor" id="textcolors">
  顏色:<input id="textcolor" name="textcolor" onchange="textout()" value="#000000">
    </label>
    <br>
  <label for="textbg" id="textbgs">
  背景:<input id="textbg" name="textbg" onchange="textout()" value="none">
    </label>
</label>
  <br><br>
  <a href="javascript:exp()" style="margin-top:30px;"><div class="expbtn"></div></a>
  </span>
</div>
  <script>
$('#loadbox,#outbox').fadeOut(1);
var cc = 0 ;

 function c() {
  cc += 0.1 ;
  $('.bar2').animate({'width': cc + '%'},1);
  }
  // Check for the File API support.
if (window.File && window.FileReader && window.FileList && window.Blob) {
  document.getElementById('files').addEventListener('change', handleFileSelect, false);
  var load = setInterval(c, 3);
  $('.bar2').css({'width':'0%'});
} else {
  alert('The File APIs are not fully supported in this browser.');
}

function handleFileSelect(evt) {
  var f = evt.target.files[0]; // FileList object
  var reader = new FileReader();
  // Closure to capture the file information.
  reader.onload = (function(theFile) {
    return function(e) {
      var binaryData = e.target.result;
      //Converting Binary Data to base 64
      var base64String = window.btoa(binaryData);
      //showing file converted to base64
      clearInterval(load);
      $('#loadbox').fadeIn(1);
      $('.bar2').animate({'width':'100%'},333);
      $('#style').html('@font-face {font-family: font;src: url(data:font/truetype;charset=utf-8;base64,' + base64String + ');font-display：swap;}');
      $('#outbox').delay(3000).fadeIn(1);
    };
  })(f);
  // Read in the image file as a data URL.
  reader.readAsBinaryString(f);
}
    
    
    function exp() {
var container = document.getElementById("textoutput");
            html2canvas(container, { allowTaint: true, backgroundColor: null }).then(function (canvas) {
                $('#outimage').html('<img src="' + canvas.toDataURL() + '">');
            });
            
}
function textout() {
document.getElementById('textoutput').innerHTML = document.getElementById('text').value ;
$('#textoutput').css({'font-size': document.getElementById('textsize').value,'color': document.getElementById('textcolor').value,'background': document.getElementById('textbg').value}); 
}

  </script>

</body>
</html>
